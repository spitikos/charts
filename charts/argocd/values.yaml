# This top-level key MUST match the alias in Chart.yaml
argocd:
  # This tells the Argo CD server that it is running behind a proxy.
  configs:
    params:
      "server.insecure": "true"

  # We explicitly set the server's service to ClusterIP to avoid port conflicts.
  server:
    service:
      type: ClusterIP

    # This section enables and configures the NGINX Ingress.
    ingress:
      enabled: true
      ingressClassName: nginx
      hosts:
        - argocd.spitikos.dev
      annotations:
        # This tells NGINX to connect to the Argo CD server using HTTPS,
        # as the server's own web server listens on TLS.
        nginx.ingress.kubernetes.io/backend-protocol: "HTTPS"
      tls:
        - hosts:
          - argocd.spitikos.dev
          # The Argo CD chart will automatically create a self-signed cert
          # if no secretName is provided, which is perfect for this setup.